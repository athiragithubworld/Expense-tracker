<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Bootstrap demo</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" 
    rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" 
    crossorigin="anonymous">
    
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" 
    integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" 
    crossorigin="anonymous"></script>

    <!-- <link rel="stylesheet" href="style.css"> -->

</head>
  <body>
    <h1>Expense Tracker</h1>
    <div class="container">
      <div id="main" class="card card-body">
      <form id="addForm" class="form-control" onsubmit="saveToLocalStorage(event)">
        <!-- <div class="row "> -->
            <!-- <div class="col"> -->
              <!-- <div class="row "> -->
                <label for="Expenseamount" class="Expenseamount">Expense Amount</label>
                <input type="number" id="Expenseamount" class="form-control"  name ="Expenseamount" required>
                <!-- <div class="col"> -->
                <label for="Description" class="description">Description</label>
                <input type="text" id="description" class="form-control" name ="description" required>
                <!-- </div> -->
                <!-- <div class="col"> -->
                <label for="Category" class="category">Category</label>
                  <!-- <input type="text" id="category"> -->
                  <!-- Selection -->
                  <select class="form-select" id="category">
                    <option>Movies</option>
                    <option>Shopping</option>
                    <option>WaterBill</option>
                    <option>ElectricityBill</option>
                  </select>
                <input type="submit" class="btn btn-dark" value="Add Expense">
          <!-- </div> -->
            
        <!-- </div> -->
      <!-- </div> -->
                
      </form> 
      <ul id="userlist" ></ul>
    </div>
    </div>
    <script>

      function saveToLocalStorage(event) {
       event.preventDefault();
       const Expenseamount=event.target.Expenseamount.value;
       const description= event.target.description.value;
       const category= event.target.category.value;
       // store the values but it will delete the previous stored value
       // localStorage.setItem('name',name);
       // localStorage.setItem('email', email);
       const obj={
        Expenseamount,
         description,
         category
       }
      localStorage.setItem(obj.Expenseamount,JSON.stringify(obj))
      showNewUserOnScreen(obj)
       }
       
       
       window.addEventListener("DOMContentLoaded",()=>{
        const  localStorageObj = localStorage;
        const localstoragekeys=Object.keys(localStorageObj);
  
        for(var i=0;i<localstoragekeys.length;i++){
          const key = localstoragekeys[i];
          const userDetailsString = localStorageObj[key];
          const userDetailsObj = JSON.parse(userDetailsString);
    showNewUserOnScreen(userDetailsObj);
  }

})
       
       function showNewUserOnScreen(user){
        document.getElementById('Expenseamount').value="";
        document.getElementById('description').value ="";
        document.getElementById('category').value="";
        
        if(localStorage.getItem(user.Expenseamount)!==null){
          removeExpenseTrackerFromScreen(user.Expenseamount)
        }

        const parentNode = document.getElementById('userlist');
  
        const childHTML  = `<li id=${user.Expenseamount}>${user.Expenseamount} - ${user.description} - ${user.category}
                                        <button onclick=deleteuser('${user.Expenseamount}')> Delete </button>
                                        <button onclick=editUserDetails('${user.Expenseamount}','${user.description}','${user.category}')>Edit </button>
                                     </li>`
        
        parentNode.innerHTML = parentNode.innerHTML + childHTML;
}

function deleteuser(Expenseamount){
  console.log(Expenseamount);
  localStorage.removeItem(Expenseamount);
  removeExpenseTrackerFromScreen(Expenseamount);
}

function removeExpenseTrackerFromScreen(Expenseamount){
  const parentNode=document.getElementById('userlist');
  const childNodeToBeDeleted = document.getElementById(Expenseamount);
  if (childNodeToBeDeleted){
    parentNode.removeChild(childNodeToBeDeleted)
  }
}
// Edit ExpenseTracker list
function editUserDetails(Expenseamount,description,category){
  document.getElementById('Expenseamount').value=Expenseamount;
  document.getElementById('description').value=description;
  document.getElementById('category').value=category;
  deleteuser(Expenseamount);
}



    </script>
  </body>
</html>